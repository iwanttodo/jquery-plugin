<!DOCTYPE html>
<html>
<head>
    <title>js解析excel</title>
    <meta charset="UTF-8" />
    <script src="js/jquery-2.0.3.min.js" type="text/javascript"></script>
    <script src="js/xlsx.full.min.js" type="text/javascript"></script>
    <script src="js/jquery.xlsx.util.js" type="text/javascript"></script>
</head>
<body>
<input type="file" name="excel" id="excelImport" />

<a href="javascript:void(0);" id="excelExport">导出</a>
<script>
    $(function(){
        // 文件改变事件
        $("#excelImport").on('change', function() {
            var file = this.files[0];

            $.xlsxImportFile(file, {
                onlyReadFirstSheet: true,   // 只读第一个sheet
                startReadRow: 1,            // 从0开始
                keys: ['id', 'name', 'sex', 'age'],                   // 对应的key值
            }, function(rows) {
                // rows 表示读取excel记录后的数组
                // do something
                console.log(rows);
            });
        });
        // 点击事件
        $("#excelExport").on('click', function() {
            var jsono = [{ //测试数据
                "id": 1,//A
                "合并的列头1": "数据11",//B
                "合并的列头2": "数据12",//C
                "合并的列头3": "数据13",//D
                "合并的列头4": "数据14",//E
            }, {
                "id": 2,
                "合并的列头1": "数据21",
                "合并的列头2": "数据22",
                "合并的列头3": "数据23",
                "合并的列头4": "数据24",
            }];//....

            $.xlsxExport(jsono);
        });



    });
</script>
</body>
</html>